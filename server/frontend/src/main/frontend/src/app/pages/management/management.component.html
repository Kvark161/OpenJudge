<common-toolbar></common-toolbar>
<div class="container">
    <div class="row"><p></p></div>
    <div class="row">
        <div class="col-sm-12">
            <div class="card">
                <div class="card-body">
                    User management
                </div>
            </div>
        </div>
    </div>
    <div class="row"><p></p></div>
    <div class="row">
        <div class="col-sm-7">
            <table class="table border">
                <thead>
                <tr>
                    <th>Username</th>
                    <th>Password</th>
                    <th>Admin</th>
                    <th></th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let user of users">
                    <td>{{user.username}}</td>
                    <td (mouseenter)="changePasswordVisibility(user, true)" (mouseleave)="changePasswordVisibility(user, false)">
                        <span *ngIf="user.passwordVisible">{{user.password}}</span>
                        <span *ngIf="!user.passwordVisible">&bull;&bull;&bull;&bull;&bull;&bull;</span>
                    </td>
                    <td>
                        <span *ngIf="user.isAdmin()"><fa [name]="'check'"></fa></span>
                    </td>
                    <td>
                        <button *ngIf="currentUser.id != user.id" type="button" class="btn btn-primary btn-sm"
                                title="Delete user"
                                (click)="deleteUser(user)">
                            <fa [name]="'trash'"></fa>
                        </button>
                    </td>
                    <td>
                        <button *ngIf="currentUser.id != user.id" type="button" class="btn btn-primary btn-sm"
                                title="Delete user"
                                (click)="editUser(user)">
                            <fa [name]="'pencil'"></fa>
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="col-sm-5">
            <div class="card">
                <div class="card-header">
                    <span *ngIf="editing">Edit</span>
                    <span *ngIf="!editing">Create</span>
                     user
                    <button *ngIf="editing" type="button" class="btn btn-primary btn-sm" title="Back to creating user" (click)="backToCreating()">
                        <fa [name]="'arrow-left'"></fa>
                    </button>
                </div>
                <div class="card-body">
                    <form>
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input type="text" id="name" class="form-control" [class.is-invalid]="validationResult.errors.username != null"
                                   [(ngModel)]="formUser.username" name="name" (input)="fieldChanged('username')"
                                   required>
                            <div type="text" class="invalid-feedback">{{validationResult.errors.username}}</div>
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="text" id="password" class="form-control" [class.is-invalid]="validationResult.errors.password != null"
                                   [(ngModel)]="formUser.password" name="password" (input)="fieldChanged('password')"
                                   required>
                            <div type="text" class="invalid-feedback">{{validationResult.errors.password}}</div>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="userRole" name="userRole"
                                   [(ngModel)]="isAdminChecked">
                            <label class="form-check-label" for="userRole">Give admin role</label>
                        </div>
                        <button type="button" class="btn btn-primary" (click)="onSubmit()">
                            <span *ngIf="editing">Edit</span>
                            <span *ngIf="!editing">Create</span>
                            user
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
